{% extends 'base.html' %}

{% block content %}
{% load widget_tweaks %}

<nav class="navbar navbar-expand-lg navbar-dark bg-primary">
    <a class="navbar-brand" href="{% url 'dashboard' %}">üè† Home</a>
    <div class="collapse navbar-collapse justify-content-end">
        <form method="POST" action="{% url 'logout' %}">
            {% csrf_token %}
            <button class="btn btn-outline-light my-2 my-sm-0" type="submit">Logout</button>
        </form>
    </div>
</nav>

<div class="container mt-4">
    <div class="d-flex justify-content-between align-items-center mb-3">
        <h2>üìö My Classes</h2>
        <button class="btn btn-success" data-bs-toggle="modal" data-bs-target="#createClassModal">
            ‚ûï Create Class
        </button>
    </div>

    <table class="table table-striped table-bordered">
        <thead class="thead-dark">
            <tr>
                <th>Name</th>
                <th>Code</th>
                <th>Scheduled Time</th>
                <th>Actions</th>
            </tr>
        </thead>
        <tbody>
            {% for classroom in classrooms %}
                <tr>
                    <td>{{ classroom.name }}</td>
                    <td>{{ classroom.code }}</td>
                    <td>{{ classroom.scheduled_time }}</td>
                    <td>
                        <a href="{% url 'edit_classroom' classroom.id %}" class="btn btn-warning btn-sm">‚úèÔ∏è Edit</a>
                        <a href="{% url 'view_students' classroom.id %}" class="btn btn-info btn-sm">üë• View Students</a>
                        <a href="{% url 'take_attendance' classroom.id %}" class="btn btn-dark btn-sm">üì∏ Take Attendance</a>
                        <form action="{% url 'delete_classroom' classroom.id %}" method="POST" style="display:inline;">
                            {% csrf_token %}
                            <button type="submit" class="btn btn-danger btn-sm" onclick="return confirm('Are you sure?')">‚ùå Delete</button>
                        </form>
                    </td>
                </tr>
            {% empty %}
                <tr>
                    <td colspan="4" class="text-center">No classes found.</td>
                </tr>
            {% endfor %}
        </tbody>
    </table>
</div>

<!-- Create Class Modal -->
<div class="modal fade" id="createClassModal" tabindex="-1" aria-labelledby="createClassModalLabel" aria-hidden="true">
    <div class="modal-dialog">
      <form method="POST" action="{% url 'list_classrooms' %}">
        {% csrf_token %}
        <div class="modal-content">
          <div class="modal-header bg-primary text-white">
            <h5 class="modal-title" id="createClassModalLabel">Create a New Class</h5>
            <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
          </div>
          <div class="modal-body">
            {% for field in form %}
              <div class="form-group mb-3">
                <label for="{{ field.id_for_label }}">{{ field.label }}</label>
                {{ field|add_class:"form-control" }}
                {% if field.errors %}
                  <div class="text-danger small">{{ field.errors|striptags }}</div>
                {% endif %}
              </div>
            {% endfor %}
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
            <button type="submit" class="btn btn-success">Create</button>
          </div>
        </div>
      </form>
    </div>
  </div>
  {% endblock %}